import type {NextPage} from 'next'
import Head from "next/head";

export async function getStaticProps(context) {
    const options = {
        method: 'POST',
        headers: {
            'x-hasura-admin-secret': 'boC5iHfKZM564RvZZ5UPpL9lp3MZLi2hMtKGsiU61P1sFRIjdzRbiRHIt6jDv3ap'
        },
        body: JSON.stringify({
            query: `query getRatings {
                ratings {
                    id
                    reviewer
                    comment
                    rate
                }
            }`,
            operationName: "getRatings"
        })
    }

    const fetchResponse = await fetch('https://amusing-krill-94.hasura.app/v1/graphql', options)
    const responseJson = await fetchResponse.json()

    return {
        props: {
            ratings: responseJson.data.ratings
        }
    }
}

const Home: NextPage = ({ratings}) => {
    return (
        <>
            <Head>
                <title>Yug Gajjar</title>
                {/* TODO: meta tags */}
                <meta name="Yug Gajjar Portfolio" content="Generated by create next app"/>
                <link rel="icon" href="/favicon.ico"/>
            </Head>

            <main>
                {ratings.map((rating) => (
                    <div>{rating.rate}</div>
                ))}
            </main>
        </>
    )
}

export default Home
